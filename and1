Java.perform(function () {

    console.log("[*] tracing start");

    // Application.attach (안정형)
    var Application = Java.use("android.app.Application");
    var attach = Application.attach.overload("android.content.Context");

    attach.implementation = function (ctx) {
        console.log("\n[+] Application.attach");
        console.log("    class:", this.getClass().getName());

        return attach.call(this, ctx);   // ← 이게 핵심 (this.attach 아님)
    };

    // Activity 첫 실행 찾기
    var Activity = Java.use("android.app.Activity");
    var onCreate = Activity.onCreate.overload("android.os.Bundle");

    onCreate.implementation = function (b) {
        var name = this.getClass().getName();

        console.log("[+] Activity:", name);

        return onCreate.call(this, b);
    };

});