ì¢‹ì•„ìš” ğŸ‘ â€”
ì´ ì˜¤ë¥˜ Cannot read property 'apply' of null ì€ Fridaì—ì„œ ìë°” ë©”ì„œë“œë¥¼ í›„í‚¹í•  ë•Œ ì›ë³¸ êµ¬í˜„(implementation)ì„ ì˜ëª» ì €ì¥í–ˆê±°ë‚˜, native ë©”ì„œë“œë¼ì„œ JS í•¨ìˆ˜ í˜•íƒœì˜ êµ¬í˜„ì´ ì—†ì„ ë•Œ ìƒê¸°ëŠ” ì „í˜•ì ì¸ ë¬¸ì œì…ë‹ˆë‹¤.

ì¦‰, savedOrig (ë˜ëŠ” orig) ë³€ìˆ˜ê°€ null í˜¹ì€ undefined ìƒíƒœì´ê¸° ë•Œë¬¸ì— .apply()ë¥¼ ì“¸ ìˆ˜ ì—†ë‹¤ëŠ” ëœ»ì´ì—ìš”.


---

ğŸ” ì›ì¸ ì •ë¦¬

1. í•´ë‹¹ ë©”ì„œë“œê°€ Java ë‹¨ì´ ì•„ë‹ˆë¼ native(C/C++)ë¡œ êµ¬í˜„ë¨ â†’ overload[i].implementation ìì²´ê°€ null


2. implementationì„ ì €ì¥í•˜ê¸° ì „ì— ë®ì–´ì”€ â†’ savedOrigê°€ ìê¸° ìì‹ (ì´ë¯¸ êµì²´ëœ í•¨ìˆ˜)ì„ ê°€ë¦¬í‚´ â†’ null ë˜ëŠ” undefined


3. Fridaê°€ ê·¸ ë©”ì„œë“œë¥¼ JSë¡œ ê°ì‹¸ì§€ ëª»í•œ ê²½ìš° â†’ (ì˜ˆ: abstract, interface, bridge method ë“±)




---

âœ… í•´ê²° ë°©ë²• â‘  (ì›ë³¸ í˜¸ì¶œ ì—†ì´ ë‹¨ìˆœ ë¡œê·¸ë§Œ ë‚¨ê¸°ê¸°)

í…ŒìŠ¤íŠ¸ë‚˜ ì¸ì í™•ì¸ ëª©ì ì´ë¼ë©´ ì›ë³¸ í˜¸ì¶œì„ ìƒëµí•˜ëŠ” ê²Œ ê°€ì¥ ê°„ë‹¨í•˜ê³  ì•ˆì „í•©ë‹ˆë‹¤.
ì´ë ‡ê²Œ í•˜ë©´ apply í˜¸ì¶œ ìì²´ê°€ í•„ìš” ì—†ì–´ìš”.

// simple_log.js
Java.perform(function () {
    var className = "Test.test.test";
    var methodName = "toParamJSONString";

    try {
        var cls = Java.use(className);
        var overloads = cls[methodName].overloads;
        for (var i = 0; i < overloads.length; i++) {
            (function (idx) {
                overloads[idx].implementation = function () {
                    var first = arguments.length > 0 ? arguments[0] : "(no args)";
                    try {
                        console.log(
                            `[${className}.${methodName} overload ${idx}] ì²«ë²ˆì§¸ ì¸ì:`,
                            first ? first.toString() : "null"
                        );
                    } catch (e) {
                        console.log("ì¶œë ¥ ì‹¤íŒ¨:", e);
                    }

                    // ì›ë³¸ í˜¸ì¶œ ëŒ€ì‹  ê·¸ëƒ¥ null ë¦¬í„´ (ì›ë³¸ ìœ ì§€ í•„ìš” ì—†ì„ ë•Œ)
                    return null;
                };
                console.log(`í›„í‚¹ ì™„ë£Œ: ${methodName} overload[${idx}]`);
            })(i);
        }
    } catch (err) {
        console.log("ì˜¤ë¥˜:", err);
    }
});

ì´ ë²„ì „ì€ ë‹¨ìˆœíˆ í˜¸ì¶œ ë¡œê·¸ë§Œ ì°ê³  ì›ë³¸ì„ ì‹¤í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
(nativeë‚˜ ì¶”ìƒ ë©”ì„œë“œë„ ì•ˆì „í•˜ê²Œ í›„í‚¹ë¨)


---

âœ… í•´ê²° ë°©ë²• â‘¡ (ì›ë³¸ì´ ì¡´ì¬í•  ë•Œë§Œ ì•ˆì „í•˜ê²Œ í˜¸ì¶œ)

ë§Œì•½ ì›ë³¸ì„ ë°˜ë“œì‹œ í˜¸ì¶œí•´ì•¼ í•œë‹¤ë©´, ë‹¤ìŒì²˜ëŸ¼ â€œì›ë³¸ì´ ì¡´ì¬í•˜ëŠ”ì§€ ê²€ì‚¬â€ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.

Java.perform(function () {
    var className = "Test.test.test";
    var methodName = "toParamJSONString";
    var cls = Java.use(className);
    var overloads = cls[methodName].overloads;

    for (var i = 0; i < overloads.length; i++) {
        (function (idx) {
            var hasOrig = overloads[idx].hasOwnProperty("implementation")
                && typeof overloads[idx].implementation === "function";
            var savedOrig = hasOrig ? overloads[idx].implementation : null;

            overloads[idx].implementation = function () {
                var first = arguments.length > 0 ? arguments[0] : "(no args)";
                console.log(`[${className}.${methodName} overload ${idx}] ì²«ë²ˆì§¸ ì¸ì:`, first);

                if (savedOrig) {
                    try {
                        return savedOrig.apply(this, arguments);
                    } catch (e) {
                        console.log("ì›ë³¸ í˜¸ì¶œ ì‹¤íŒ¨:", e);
                    }
                } else {
                    console.log("ì›ë³¸ êµ¬í˜„ ì—†ìŒ (native ë˜ëŠ” abstract)");
                }
                return null;
            };
            console.log(`í›„í‚¹ ì™„ë£Œ: ${methodName} overload[${idx}]`);
        })(i);
    }
});

ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒì²˜ëŸ¼ ë™ì‘í•©ë‹ˆë‹¤:

ì›ë³¸ì´ ì¡´ì¬í•˜ë©´ .apply() í˜¸ì¶œ

ì›ë³¸ì´ ì—†ìœ¼ë©´ ë‹¨ìˆœíˆ ë¡œê·¸ ì¶œë ¥ í›„ null ë¦¬í„´



---

âœ… ì¶”ê°€ í™•ì¸ë²•

ë¬¸ì œ ë˜ëŠ” ë©”ì„œë“œê°€ ì‹¤ì œë¡œ nativeì¸ì§€ í™•ì¸í•˜ë ¤ë©´ Frida ì½˜ì†”ì—ì„œ ì•„ë˜ì²˜ëŸ¼ ì‹¤í–‰í•´ë³´ì„¸ìš”:

frida -U -f com.example.app --no-pause

ê·¸ë¦¬ê³  ë‚´ë¶€ REPLì—ì„œ:

Java.perform(function(){
  var c = Java.use("Test.test.test");
  c.toParamJSONString.overloads.forEach(function(o){ console.log(o); });
});

â†’ ì¶œë ¥ëœ ì‹œê·¸ë‹ˆì²˜ë¥¼ ë³´ë©´ nativeê°€ ë¶™ì–´ìˆìœ¼ë©´ ì›ë³¸ í˜¸ì¶œì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
(ì˜ˆ: public native java.lang.String toParamJSONString(java.lang.String arg))


---

ğŸ”§ ê²°ë¡ 

Cannot read property 'apply' of null â†’ implementationì´ ì—†ê±°ë‚˜ nullì„

ë‹¨ìˆœ ë¡œê·¸ë§Œ ì°ì„ ê²½ìš° ì›ë³¸ í˜¸ì¶œ ì œê±°í•˜ë©´ 100% ì•ˆì „

ì›ë³¸ í˜¸ì¶œì´ ê¼­ í•„ìš”í•˜ë©´ null ì²´í¬ ì¶”ê°€



---

ì›í•˜ì‹ ë‹¤ë©´ í•´ë‹¹ í´ë˜ìŠ¤(Test.test.test)ì˜ toParamJSONString ì‹œê·¸ë‹ˆì²˜(ì˜ˆ: String toParamJSONString(String)ì¸ì§€ ë“±)ë¥¼ ì•Œë ¤ì£¼ì‹œë©´, ì •í™•í•œ ì˜¤ë²„ë¡œë“œ í•˜ë‚˜ë§Œ ì•ˆì „í•˜ê²Œ í›„í‚¹í•´ì„œ ì›ë³¸ í˜¸ì¶œ ìœ ì§€í•˜ëŠ” ì½”ë“œë¡œ ì •ë¦¬í•´ë“œë¦´ê²Œìš”.

