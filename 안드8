
const targets = [
    "JNIEnvExt::CallStaticVoidMethod",
    "JNIEnvExt::CallVoidMethod",
    "JNIEnvExt::CallStaticIntMethod"
];

targets.forEach(name => {
    const f = Module.findExportByName("libart.so", name)
          || Module.findExportByName("libartbase.so", name);

    if (!f) return;

    Interceptor.attach(f, {
        onEnter(args) {
            const ra = this.returnAddress;
            const m = Process.findModuleByAddress(ra);

            if (m && m.name.startsWith("libguard")) {
                console.log("\n[ART entry]");
                console.log("caller:", m.name);
                console.log("offset:", ra.sub(m.base));
            }
        }
    });
});