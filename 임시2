const moduleName = "libzwfeyyadt.so";

function hookJniOnLoad() {
    const m = Process.findModuleByName(moduleName);
    if (!m) {
        setTimeout(hookJniOnLoad, 100);
        return;
    }

    const jniOnLoad = Module.findExportByName(moduleName, "JNI_OnLoad");
    if (!jniOnLoad) {
        console.log("JNI_OnLoad not found");
        return;
    }

    console.log("[+] JNI_OnLoad @", jniOnLoad);

    Interceptor.attach(jniOnLoad, {
        onEnter(args) {
            console.log("[*] JNI_OnLoad entered");
        },
        onLeave(retval) {
            console.log("[*] JNI_OnLoad ret =", retval);
            retval.replace(ptr(0x00010006)); // JNI_VERSION_1_6
        }
    });
}

hookJniOnLoad();